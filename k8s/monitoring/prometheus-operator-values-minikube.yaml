# Valores optimizados para Minikube (recursos reducidos)
# Uso: helm install prometheus prometheus-community/kube-prometheus-stack -n monitoring --create-namespace -f k8s/monitoring/prometheus-operator-values-minikube.yaml

# Configuración de Prometheus (recursos reducidos)
prometheus:
  enabled: true
  prometheusSpec:
    retention: 7d  # Reducido de 30d a 7d
    retentionSize: 10GB  # Reducido de 50GB a 10GB
    scrapeInterval: 60s  # Aumentado de 30s a 60s para reducir carga
    evaluationInterval: 60s
    resources:
      requests:
        memory: 512Mi  # Reducido de 2Gi
        cpu: 250m  # Reducido de 1000m
      limits:
        memory: 1Gi  # Reducido de 4Gi
        cpu: 500m  # Reducido de 2000m
    serviceMonitorSelectorNilUsesHelmValues: false
    podMonitorSelectorNilUsesHelmValues: false
    ruleSelectorNilUsesHelmValues: false
    serviceMonitorNamespaceSelector: {}
    podMonitorNamespaceSelector: {}
    ruleNamespaceSelector: {}
    # Reducir réplicas
    replicas: 1

# Configuración de Grafana (recursos reducidos)
grafana:
  enabled: true
  adminUser: admin
  adminPassword: admin123
  persistence:
    enabled: true
    size: 5Gi  # Reducido de 10Gi
    storageClassName: standard  # Usar standard en lugar de fast-ssd
  resources:
    requests:
      memory: 256Mi  # Reducido de 512Mi
      cpu: 100m  # Reducido de 250m
    limits:
      memory: 512Mi  # Reducido de 1Gi
      cpu: 250m  # Reducido de 500m
  service:
    type: ClusterIP
    port: 3000
  # Deshabilitar algunos plugins para reducir tamaño
  plugins: []

# Configuración de AlertManager (recursos reducidos)
alertmanager:
  enabled: true
  alertmanagerSpec:
    replicas: 1
    resources:
      requests:
        memory: 128Mi
        cpu: 100m
      limits:
        memory: 256Mi
        cpu: 200m
  config:
    global:
      resolve_timeout: 5m
    route:
      group_by: ['alertname', 'cluster', 'service']
      group_wait: 10s
      group_interval: 10s
      repeat_interval: 12h
      receiver: 'default'
      routes:
      - match:
          severity: critical
        receiver: 'critical'
      - match:
          severity: warning
        receiver: 'warning'
    receivers:
    - name: 'default'
    - name: 'critical'
    - name: 'warning'

# Configuración de Node Exporter (deshabilitado para ahorrar recursos)
nodeExporter:
  enabled: false  # Deshabilitado para Minikube

# Configuración de Kube State Metrics (recursos reducidos)
kubeStateMetrics:
  enabled: true
  resources:
    requests:
      memory: 64Mi
      cpu: 50m
    limits:
      memory: 128Mi
      cpu: 100m

# Deshabilitar componentes opcionales
prometheusOperator:
  resources:
    requests:
      memory: 128Mi
      cpu: 100m
    limits:
      memory: 256Mi
      cpu: 200m

